{% set site_url = config.site_url | d(nav.homepage.url, true) | url %}
{% if not config.use_directory_urls and site_url[0] == site_url[-1] == "." %}
    {% set site_url = site_url ~ "/index.html" %}
{% endif %}
<header class="md-header" data-md-component="header">
    <nav class="md-header-nav md-grid" aria-label="{{ lang.t('header.title') }}">
        <a href="{{ site_url }}" title="{{ config.site_name | e }}" class="md-header-nav__button md-logo" aria-label="{{ config.site_name }}">
            {% include "partials/logo.html" %}
        </a>
        <label class="md-header-nav__button md-icon" for="__drawer">
            {% include ".icons/material/menu" ~ ".svg" %}
        </label>
        <div class="md-header-nav__title" data-md-component="header-title">
            <div class="md-header-nav__ellipsis">
                <div class="md-header-nav__topic">
                    <span class="md-ellipsis">
                        {{ config.site_name }}
                    </span>
                </div>
                <div class="md-header-nav__topic">
                    <span class="md-ellipsis">
                        {% if page and page.meta and page.meta.title %}
                        {{ page.meta.title }}
                        {% else %}
                        {{ page.title }}
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
        {% if "search" in config["plugins"] %}
            <label class="md-header-nav__button md-icon" for="__search">
                {% include ".icons/material/magnify.svg" %}
            </label>
            {% include "partials/search.html" %}
        {% endif %}
        {% if config.repo_url %}
            <div class="md-header-nav__source">
                {% include "partials/source.html" %}
            </div>
        {% endif %}
        <div class="md-header-nav__theme" id="color-changer">
            <span class="md-source__icon md-icon light" title="Light Mode" data-md-color-scheme="slate">{% include ".icons/material/white-balance-sunny.svg" %}</span>
            <span class="md-source__icon md-icon dark" title="Dark Mode" data-md-color-scheme="preference">{% include ".icons/material/weather-night.svg" %}</span>
        </div>
        <style>
            .md-header-nav__theme:hover {
                cursor: pointer;
            }

            [data-md-color-scheme=preference] .md-icon.dark {
                display: none;
            }

            [data-md-color-scheme=slate] .md-icon.light {
                display: none;
            }
        </style>
        <script>
            var buttons = document.querySelectorAll("#color-changer > span")
            buttons.forEach(function(button) {
                button.addEventListener("click", function() {
                    var attr = this.getAttribute("data-md-color-scheme")
                    document.body.setAttribute("data-md-color-scheme", attr)
                    // var name = document.querySelector("#__code_0 code span:nth-child(7)")
                    // name.textContent = attr
                })
            });
        </script>
    </nav>
</header>
